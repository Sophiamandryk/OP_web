<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Профіль користувача</title>
    <style>
        :root {
            --main-bg-color: #8a9a72;
            --light-green: #dae5cb;
            --button-green: #c5d9af;
            --text-color: #333;
            --yellow-accent: #f0c75e;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background-color: var(--main-bg-color);
            color: var(--text-color);
        }
        
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 50px;
            background-color: var(--main-bg-color);
        }
        
        .nav-logo {
            font-weight: bold;
            font-size: 1.2rem;
            color: white;
            cursor: pointer;
        }
        
        .nav-links {
            display: flex;
            gap: 20px;
        }
        
        .nav-link {
            color: white;
            text-decoration: none;
            font-weight: 500;
        }
        
        .user-area {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-button {
            background-color: var(--button-green);
            border-radius: 50px;
            padding: 10px 20px;
            border: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification-badge {
            background-color: var(--yellow-accent);
            border-radius: 50px;
            padding: 10px 15px;
            font-weight: bold;
        }
        
        .profile-container {
            max-width: 1100px;
            margin: 20px auto;
            background-color: var(--light-green);
            border-radius: 15px;
            padding: 30px;
            position: relative;
        }
        
        .back-button {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: var(--text-color);
            font-weight: bold;
            margin-bottom: 20px;
            cursor: pointer;
        }
        
        .profile-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .profile-image {
            width: 120px;
            height: 120px;
            background-color: var(--button-green);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
            position: relative;
            cursor: pointer;
            overflow: hidden;
        }
        
        .profile-image:hover::after {
            content: "Змінити фото";
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 5px;
            font-size: 12px;
            text-align: center;
        }
        
        .avatar-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        #uploadSuccessMessage {
            display: none;
            color: green;
            margin-top: 10px;
            font-size: 14px;
            text-align: center;
        }
        
        .edit-profile-btn {
            background-color: var(--button-green);
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            font-weight: 500;
            cursor: pointer;
        }
        
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 15px;
        }
        
        .menu-button {
            background-color: var(--button-green);
            border: none;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            width: 100%;
            text-align: left;
            font-size: 1.2rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .menu-button:hover {
            background-color: #b8cea0;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-logo" id="makeRequestButton">Зробити запит</div>
        <div class="nav-links">
            <a href="#" class="nav-link">Про нас</a>
            <a href="#" class="nav-link" id="homeLink">Головна</a>
            <a href="#" class="nav-link" id="logoutButton">Вийти</a>
        </div>
        <div class="user-area">
            <button class="user-button">@user_name</button>
            <div class="notification-badge">Need!</div>
        </div>
    </nav>
    
    <div class="profile-container">
        <a href="#" class="back-button" id="backButton">
            ← Профіль користувача
        </a>
        
        <div class="profile-header">
            <div class="profile-image" id="profileImageContainer">
                <svg width="50" height="50" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 16L8.586 11.414C8.96106 11.0389 9.46967 10.8284 10 10.8284C10.5303 10.8284 11.0389 11.0389 11.414 11.414L16 16M14 14L15.586 12.414C15.9611 12.0389 16.4697 11.8284 17 11.8284C17.5303 11.8284 18.0389 12.0389 18.414 12.414L20 14M14 8H14.01M6 20H18C18.5304 20 19.0391 19.7893 19.4142 19.4142C19.7893 19.0391 20 18.5304 20 18V6C20 5.46957 19.7893 4.96086 19.4142 4.58579C19.0391 4.21071 18.5304 4 18 4H6C5.46957 4 4.96086 4.21071 4.58579 4.58579C4.21071 4.96086 4 5.46957 4 6V18C4 18.5304 4.21071 19.0391 4.58579 19.4142C4.96086 19.7893 5.46957 20 6 20Z" stroke="grey" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div id="uploadSuccessMessage">Фото успішно оновлено!</div>
            <button class="edit-profile-btn" id="editProfileButton">Редагувати профіль</button>
        </div>
        
        <div class="section">
            <h2 class="section-title">Донати :</h2>
            <button class="menu-button" id="myDonationsButton">Мої донати</button>
            <button class="menu-button" id="mySubscriptionsButton">Мої підписки</button>
        </div>
        
        <div class="section">
            <h2 class="section-title">Збори :</h2>
            <button class="menu-button" id="myFundraisingHistoryButton">Історія моїх зборів</button>
            <button class="menu-button" id="unfinishedFundraisingButton">Незавершені збори</button>
            <button class="menu-button" id="completedFundraisingButton">Завершені збори</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Display username
            if (typeof displayUsername === 'function') {
                displayUsername();
            }
            
            // Setup button handlers - use direct URL navigation
            document.getElementById('editProfileButton').addEventListener('click', function() {
                window.location.href = 'change_profile.html';
            });
            
            document.getElementById('backButton').addEventListener('click', function(event) {
                event.preventDefault();
                window.location.href = 'detailed_needs.html';
            });

            document.getElementById('homeLink').addEventListener('click', function(event) {
                event.preventDefault();
                // Use direct navigation or function if available
                if (typeof goToHome === 'function') {
                    goToHome();
                } else {
                    window.location.href = 'needs.html';
                }
            });
            
            // Menu button functionality
            const menuButtons = document.querySelectorAll('.menu-button');
            menuButtons.forEach(button => {
                button.addEventListener('click', function() {
                    alert('Функціональність "' + button.textContent + '" у розробці');
                });
            });
            
            // Fix for profile image upload with direct implementation
            const profileImage = document.getElementById('profileImageContainer');
            if (profileImage) {
                profileImage.addEventListener('click', function() {
                    // Create a file input element
                    const fileInput = document.createElement('input');
                    fileInput.type = 'file';
                    fileInput.accept = 'image/*';
                    fileInput.style.display = 'none';
                    
                    // Handle file selection directly here
                    fileInput.addEventListener('change', function() {
                        const file = this.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                // Replace the container content with the image
                                profileImage.innerHTML = `<img src="${e.target.result}" class="avatar-image" alt="Profile Picture">`;
                                
                                // Show success message
                                document.getElementById('uploadSuccessMessage').style.display = 'block';
                                setTimeout(() => {
                                    document.getElementById('uploadSuccessMessage').style.display = 'none';
                                }, 3000);
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                    
                    // Add to DOM temporarily, click it, then remove
                    document.body.appendChild(fileInput);
                    fileInput.click();
                    setTimeout(() => document.body.removeChild(fileInput), 100);
                });
            }
            
            // Add functionality to "Зробити запит" button
            const makeRequestButton = document.querySelector('.nav-logo');
            if (makeRequestButton) {
                makeRequestButton.addEventListener('click', function() {
                    window.location.href = 'make_request.html';
                });
            }
            
            // Initialize any global functions if needed
            if (typeof setupProfileImageUploaders === 'function') {
                setupProfileImageUploaders();
            }
        });
    </script>
</body>
</html>